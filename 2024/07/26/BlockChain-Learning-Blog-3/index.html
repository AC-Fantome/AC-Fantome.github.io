<!DOCTYPE html>
<html lang="zn-Ch">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Fantome">





<title>BlockChain Learning Blog 3 | Fantome&#39;s Blog</title>



    <link rel="icon" href="/project/Deep%20River.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/project/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/project/js/script.js"></script>
    
    <script src="/project/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/project/">Fantome&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/project/archives">Posts</a>
                
                    <a class="menu-item" href="/project/category">Categories</a>
                
                    <a class="menu-item" href="/project/tag">Tags</a>
                
                    <a class="menu-item" href="/project/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/project/">Fantome&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/project/archives">Posts</a>
                
                    <a class="menu-item" href="/project/category">Categories</a>
                
                    <a class="menu-item" href="/project/tag">Tags</a>
                
                    <a class="menu-item" href="/project/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">BlockChain Learning Blog 3</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Fantome</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">July 26, 2024&nbsp;&nbsp;18:29:41</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="1-使用主链侧链技术"><a href="#1-使用主链侧链技术" class="headerlink" title="1. 使用主链侧链技术"></a>1. 使用主链侧链技术</h2><p><em><strong>阅读论文《基于侧链的链上链下数据协同研究》</strong></em></p>
<ol>
<li><p><strong>基础结构</strong>:</p>
<p>主链——公有链-以太坊</p>
<p>侧链——联盟链-Hyperledger Fabric</p>
<p>主链和侧链之间的数据交互方案: 基于主链和侧链上的多个合约, 结合多种双向锚定技术, 保证链上链下数据的一致性.</p>
<p>将主链的部分计算卸载到侧链上, 以减少主链的计算量, 并且利用联盟链的优势 (PBFT等确定性共识算法) 提高出块速度, 增加吞吐量.</p>
<p>使用LSM-Tree中的键值分离思想对区块链存储世界状态的K-V数据库中LSM-Tree进行键值分离, 利用改进的状态数据库来实现侧链底层存储接口, 使其作为侧链的可插拔数据库.</p>
</li>
<li><p><strong>方案设计</strong>:</p>
<p>主链和侧链都有自己独立的用户信息, 智能合约, 资产, 数据状态, 而主链和侧链通过三个方案保证链上状态和链下状态保持一致.</p>
<p>在主链上通过智能合约记录侧链配置信息, 锁币信息, 侧链区块高度与区块哈希状态信息等.</p>
<p>在侧链上通过智能合约实现ERC20 Token, 并基于ERC20 Token实现铸币和毁币等功能.</p>
<p><img src="C:\Users\wjx27\AppData\Roaming\Typora\typora-user-images\image-20240510201249099.png" alt="image-20240510201249099"></p>
<p>该方案的特点:</p>
<ol>
<li>侧链和主链之间具有独立性, 侧链智能合约的执行不需要主链的签名和背书;</li>
<li>链上链下数据的一致性;</li>
<li>交易的真实性和正确性, 在一致性的前提下, 主链和侧链的智能合约保证了各自区块链的安全性.</li>
</ol>
</li>
<li><p><strong>方案概览</strong> (超级简略version):</p>
<ul>
<li><p>链上链下数据交互方案: 方案使用双向锚定技术, 在执行主链与侧链的跨链操作时, 主链上的信息和资产等暂时锁定在以太坊智能合约中, 将等值的信息和资产等在侧链上释放, 而侧链上的数据管理和释放使用基于联盟托管的混合跨链方式.</p>
<p>[^基于联盟托管的混合跨链]: 使用主链与侧链上的多 个智能合约, 包括记录侧链配置的智能合约, 锁币智能合约与侧链Token智能合约等.</p>
<p>使用基于联盟托管的混合跨链方法来实现网关应用程序, 网关应用程序中分为不同的管理角色 (具体实现代码略):</p>
<ol>
<li>watcher负责网关应用程序中的监听功能, 既是主链的全节点, 又是侧链的全节点.</li>
<li>confirmer负责对watcher监听到的消息进行验证，一般是侧链管理员组织中的多个可信成员以及监管部门的成员.</li>
<li>executor负责将watcher监听到的信息卸载到侧链上, 如果监听到的信息是资产锁定事件, executor在侧链上执行铸币操作并根据事件中交易的金额转移相应的Token, 既是侧链的铸币者, 又是主链智能合约的拥有者.</li>
</ol>
</li>
<li><p>链上链下身份协同方案: 方案通过主链账户地址和侧链账户用户名结合的方式, 打通侧链中公钥基础结构PKI和以太坊的公钥密码技术.</p>
</li>
<li><p>链上链下状态及时性方案:方案使用主链智能合约记录侧链区块高度和侧链区块哈希的方式来记录侧链的状态, 具体实现是由watcher监听区块事件, 将侧链区块状态追加记录到主链.</p>
</li>
</ul>
</li>
<li><p><strong>整体方案</strong>:</p>
<p>假设协议只有Alice和Bob两个用户 (该协议可以拓展到多用户, 并不失一般性), Alice与Bob在主链锁定资产, 分为以下几步:</p>
<ol>
<li>通过链上链下数据交互方案将两用户资产卸载到侧链;</li>
<li>通过链上链下身份协同方案生成用户Alice与Bob的侧链身份, Alice与Bob在侧链执行交易, 交易执行完毕后;</li>
<li>通过链上链下数据交互方案将两用户执行交易后资产状态返回到主链.</li>
</ol>
<p>同时, 链上链下状态及时性方案负责将侧链当前区块高度与区块哈希及时上传至主链进行记录.</p>
<p>看不懂怎么提升侧链的吞吐量, 遂略 (如果被抓包了, 先提前私密马赛).</p>
</li>
<li><p><strong>基于侧链的区块链监管方式</strong>:</p>
<p>主链的去中心化性使得其难以被监管, 但是侧链使用的联盟链Hyperledger Fabric可引入监管部门作为特殊组织加入联盟链网络.</p>
<p>基于链上链下身份协同方案, 监管部门可以轻松识别公有链用户的身份; 然后通过侧链的管理员组织和监管部门的特殊组织对侧链进行监督与管理, 管理员组织成员包括侧链管理员, 侧链Token铸币者, 主链智能合约拥有者等. 最后, 在侧链中将监管部门的特殊组织引入区块链每一个通道中, 让监管部门参与交易的背书策略.</p>
<p>[^背书策略]: 指负责背书的节点为该区块链上的交易进行验证, 对验证通过的交易进行担保.</p>
</li>
</ol>
<h2 id="2-实现交易信息溯源功能"><a href="#2-实现交易信息溯源功能" class="headerlink" title="2. 实现交易信息溯源功能"></a>2. 实现交易信息溯源功能</h2><p><em><strong>阅读论文《基于侧链技术的供应链溯源系统设计》</strong></em></p>
<p>大致流程:</p>
<p>1.企业 (商家) 将数据上侧链服务器网络, 侧链将数据处理后 (哈希锁定) 上传至以太坊公链.</p>
<p>2.监管方可访问侧链服务器, 同时检验与以太坊公链上的数据是否一致, 有无篡改.</p>
<img src="C:\Users\wjx27\AppData\Roaming\Typora\typora-user-images\image-20240509161910064.png" alt="image-20240509161910064" style="zoom: 67%;" />









<h2 id="3-合约的安全性体现"><a href="#3-合约的安全性体现" class="headerlink" title="3. 合约的安全性体现"></a>3. 合约的安全性体现</h2><ol>
<li><p><strong>智能合约的第三方安全检查工具</strong></p>
<ul>
<li><strong>Mythril</strong>：一个开源的工具，用于在以太坊智能合约中检测安全漏洞。Mythril提供了一个命令行接口，可以分析智能合约的字节码，寻找潜在的安全问题。</li>
<li><strong>Slither</strong>：由Trail of Bits开发的一个静态分析框架，用于检测Solidity智能合约中的漏洞。Slither能够识别各种问题，包括重入漏洞、不安全的自毁操作等。</li>
<li><strong>SmartCheck</strong>：一个用于Solidity源代码的静态分析工具，能够帮助识别智能合约中的安全漏洞和反模式。</li>
<li><strong>Securify</strong>：由ETH Zurich开发的在线工具，用于对以太坊智能合约进行自动安全审计。Securify使用模式匹配技术来识别常见的安全问题。</li>
<li><strong>Manticore</strong>：一个符号执行工具，用于分析二进制文件和智能合约。Manticore能够检测智能合约中的多种安全问题，包括交易顺序依赖性(TOD)问题、整数溢出等。</li>
<li><strong>Echidna</strong>：由Trail of Bits开发的模糊测试工具，用于以太坊智能合约。Echidna通过生成随机输入来测试智能合约的状态，以此来寻找可能导致异常行为的输入。</li>
<li><strong>Oyente</strong>：一个用于分析以太坊智能合约的安全性的工具，能够检测多种类型的安全漏洞。</li>
</ul>
</li>
<li><p><strong>保护性编程和安全编码</strong> (基于靶场训练总结)</p>
<ul>
<li>使用安全库: 如使用SafeMath库防止数据溢出的异常情况等.</li>
<li>重入攻击: 基于重入攻击的原理, 可使用”检查-生效-交互” (Check-Effect-Interaction) 模式或重入锁 (Reentrancy Guard) 来有效防御此类攻击, 或者限制外部合约尤其是未知不信任合约的调用, 又或者在测试时对重入攻击有专门并且彻底的测试.</li>
<li>随机数安全性: 基于区块哈希, 时间戳, 交易数据生成的随机数, 如果被攻击者控制或预测了这些数据, 可能会操纵随机数的生成, 导致遭到攻击, 因此随机数生成可以使用其他方法, 如链下生成随机数, 多方计算和VPF等.</li>
<li>除以上提到的几种攻击, 还有编程上的问题, 如不安全的外部合约调用, 不安全的转移和接受资产方式等, 这些都需要保护性编程技术来解决, 以增强合约的安全性.</li>
</ul>
</li>
</ol>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Fantome</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://username.github.io/project/2024/07/26/BlockChain-Learning-Blog-3/">https://username.github.io/project/2024/07/26/BlockChain-Learning-Blog-3/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/project/tags/BlockChain/"># BlockChain</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/project/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/project/2024/07/26/BlockChain-Learning-Blog-2/">BlockChain Learning Blog 2</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Fantome | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
<div class="theme-info">
    <div class="powered-by"></div>
    <span class="post-count">博客全站共{{ totalcount(site) }}字</span>
  </div>  

    </div>
</body>

</html>